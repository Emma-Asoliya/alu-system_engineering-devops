#!/usr/bin/env bash
# Ignore SC2154 shellcheck warning, as we're assuming the variable is passed or defined elsewhere.
# shellcheck disable=SC2154

# Update system packages
sudo apt update -y
sudo apt upgrade -y

# Install necessary packages (choose nginx or apache2, depending on your preference)
sudo apt install -y nginx

# Create a custom HTTP response header configuration
# In this example, we'll add a custom header for nginx. 

# Define the custom header value (you can modify this as needed)
CUSTOM_HEADER="X-Custom-Header: MyCustomValue"

# Adding custom header to nginx configuration
echo 'add_header X-Custom-Header "MyCustomValue" always;' | sudo tee -a /etc/nginx/nginx.conf

# Reload nginx to apply the changes
sudo systemctl reload nginx

# Check if nginx is running
sudo systemctl status nginx

# Optionally, you can create a simple test page
echo "<html><body><h1>Ubuntu Machine Configured!</h1></body></html>" | sudo tee /var/www/html/index.html

# Enable nginx to start on boot
sudo systemctl enable nginx

# Final message
echo "Configuration complete. Custom HTTP response header is now set!"
